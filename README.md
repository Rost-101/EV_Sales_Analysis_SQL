# –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ–¥–∞–∂—ñ–≤ –µ–ª–µ–∫—Ç—Ä–æ–º–æ–±—ñ–ª—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é SQL

–¶–µ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –º—ñ—Å—Ç–∏—Ç—å –ø—Ä–æ—î–∫—Ç, —è–∫–∏–π –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –∞–Ω–∞–ª—ñ–∑ –ø—Ä–æ–¥–∞–∂—ñ–≤ –µ–ª–µ–∫—Ç—Ä–æ–º–æ–±—ñ–ª—ñ–≤ (EV) —Ç–∞ —ó—Ö–Ω—å–æ–≥–æ –≤–ø—Ä–æ–≤–∞–¥–∂–µ–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é SQL. –ü–æ—á–∞—Ç–∫–æ–≤–∏–π –∞–Ω–∞–ª—ñ–∑ –±—É–≤ –≤–∏–∫–æ–Ω–∞–Ω–∏–π —É Google Sheets, –∞ –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∏–π –¥–æ SQL –¥–ª—è –±—ñ–ª—å—à –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –≥–ª–∏–±—à–∏—Ö —ñ–Ω—Å–∞–π—Ç—ñ–≤.

## –û–≥–ª—è–¥

–ü—Ä–æ—î–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –º–æ—ó –Ω–∞–≤–∏—á–∫–∏ –∞–Ω–∞–ª—ñ–∑—É –¥–∞–Ω–∏—Ö –ø—Ä–æ–¥–∞–∂—ñ–≤ –µ–ª–µ–∫—Ç—Ä–æ–º–æ–±—ñ–ª—ñ–≤, —è–∫—ñ —Å–ø–æ—á–∞—Ç–∫—É –±—É–ª–∏ –∑—ñ–±—Ä–∞–Ω—ñ —Ç–∞ –ø—Ä–æ–∞–Ω–∞–ª—ñ–∑–æ–≤–∞–Ω—ñ –≤ Google Sheets, –∞ –ø–æ—Ç—ñ–º –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ñ –≤ SQL –¥–ª—è –ø–æ–≥–ª–∏–±–ª–µ–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É. –ù–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö –≤–∫–ª—é—á–∞—î —Ä—ñ–∑–Ω—ñ –∞—Ç—Ä–∏–±—É—Ç–∏, —Ç–∞–∫—ñ —è–∫ —Ä–µ–≥—ñ–æ–Ω–∏ –ø—Ä–æ–¥–∞–∂—ñ–≤, –º–∞—Ä–∫–∏ –∞–≤—Ç–æ–º–æ–±—ñ–ª—ñ–≤, —Ç–∏–ø–∏, —î–º–Ω—ñ—Å—Ç—å –±–∞—Ç–∞—Ä–µ–π, —Å–µ–≥–º–µ–Ω—Ç–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤ —Ç–∞ –º–µ—Ç—Ä–∏–∫–∏ –¥–æ—Ö–æ–¥—ñ–≤. –¶–µ–π README –æ–ø–∏—Å—É—î —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–∏—Ö —Ç–∞ –ø—ñ–¥—Ö—ñ–¥ –¥–æ –∞–Ω–∞–ª—ñ–∑—É –≤ SQL.

## –ù–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö

–ù–∞–±—ñ—Ä –¥–∞–Ω–∏—Ö, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π —É —Ü—å–æ–º—É –ø—Ä–æ—î–∫—Ç—ñ, –≤–∫–ª—é—á–∞—î —Ç–∞–∫—ñ –ø–æ–ª—è:

- **Date**: –ú—ñ—Å—è—Ü—å —É —Ñ–æ—Ä–º–∞—Ç—ñ –†–†–†–†-–ú–ú  
- **Region**: –ì–µ–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∏–π —Ä–µ–≥—ñ–æ–Ω, –¥–µ –≤—ñ–¥–±—É–≤–∞–ª–∏—Å—è –ø—Ä–æ–¥–∞–∂—ñ  
- **Brand**: –ê–≤—Ç–æ–º–æ–±—ñ–ª—å–Ω–∞ –º–∞—Ä–∫–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, Toyota, BYD, Tesla...)  
- **Vehicle_Type**: –ö–∞—Ç–µ–≥–æ—Ä—ñ—è (Crossover, Truck, Sedan, Hatchback...)  
- **Battery_Capacity_kWh**: –Ñ–º–Ω—ñ—Å—Ç—å –±–∞—Ç–∞—Ä–µ—ó –≤ –∫—ñ–ª–æ–≤–∞—Ç-–≥–æ–¥–∏–Ω–∞—Ö  
- **Discount_Percentage**: –ó–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–∞ –∑–Ω–∏–∂–∫–∞ —É –≤—ñ–¥—Å–æ—Ç–∫–∞—Ö  
- **Customer_Segment**: –°–µ–≥–º–µ–Ω—Ç –∫–ª—ñ—î–Ω—Ç—ñ–≤ ( High Income, Middle Income, Budget Conscious)  
- **Fast_Charging_Option**: –ß–∏ –ø—ñ–¥—Ç—Ä–∏–º—É—î —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∏–π –∑–∞—Å—ñ–± —à–≤–∏–¥–∫—É –∑–∞—Ä—è–¥–∫—É  
- **Units_Sold**: –ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–¥–∞–Ω–∏—Ö –æ–¥–∏–Ω–∏—Ü—å  
- **Revenue**: –ó–∞–≥–∞–ª—å–Ω–∏–π –¥–æ—Ö—ñ–¥ –≤—ñ–¥ –ø—Ä–æ–¥–∞–Ω–∏—Ö –æ–¥–∏–Ω–∏—Ü—å  

–î–∞–Ω—ñ –∑ Google Sheets –±—É–ª–∏ —ñ–º–ø–æ—Ä—Ç–æ–≤–∞–Ω—ñ –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö SQL –¥–ª—è –ø–æ–¥–∞–ª—å—à–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è SQL –¥–æ–∑–≤–æ–ª–∏–ª–æ:
- –í–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Å–∫–ª–∞–¥–Ω—ñ –∑–∞–ø–∏—Ç–∏ –¥–ª—è –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞–≥–∞–ª—å–Ω–∏–π –¥–æ—Ö—ñ–¥ –∑–∞ —Ä–µ–≥—ñ–æ–Ω–∞–º–∏ –∞–±–æ –º–∞—Ä–∫–∞–º–∏).
- –§—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏ –¥–∞–Ω—ñ –∑–∞ —Ä—ñ–∑–Ω–∏–º–∏ –∫—Ä–∏—Ç–µ—Ä—ñ—è–º–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, —Å–µ–≥–º–µ–Ω—Ç–∏ –∫–ª—ñ—î–Ω—Ç—ñ–≤ –∞–±–æ —Ç–∏–ø–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∏—Ö –∑–∞—Å–æ–±—ñ–≤).
- –ê–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —Ç—Ä–µ–Ω–¥–∏ –ø—Ä–æ–¥–∞–∂—ñ–≤ –∑–∞ –º—ñ—Å—è—Ü—è–º–∏ —Ç–∞ —Ä–µ–≥—ñ–æ–Ω–∞–º–∏.

## –í–∏–∫–æ–Ω–∞–Ω—ñ –∑–∞–≤–¥–∞–Ω–Ω—è

–ù–∏–∂—á–µ –Ω–∞–≤–µ–¥–µ–Ω–æ –ø—Ä–∏–∫–ª–∞–¥–∏ SQL-–∑–∞–ø–∏—Ç—ñ–≤, —è–∫—ñ —è –≤–∏–∫–æ–Ω–∞–≤ –¥–ª—è –∞–Ω–∞–ª—ñ–∑—É –¥–∞–Ω–∏—Ö, —Ä–∞–∑–æ–º —ñ–∑ —ó—Ö–Ω—å–æ—é –º–µ—Ç–æ—é.

### –ó–∞–≤–¥–∞–Ω–Ω—è 1: –ê–Ω–∞–ª—ñ–∑ –¥–æ—Ö–æ–¥—É –∑–∞ –±—Ä–µ–Ω–¥–∞–º–∏ –≤ –ü—ñ–≤–Ω—ñ—á–Ω—ñ–π –ê–º–µ—Ä–∏—Ü—ñ
**–ú–µ—Ç–∞**: –í–∏–∑–Ω–∞—á–∏—Ç–∏ –∑–∞–≥–∞–ª—å–Ω–∏–π –¥–æ—Ö—ñ–¥ (Revenue) –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –±—Ä–µ–Ω–¥—É (Brand) —É —Ä–µ–≥—ñ–æ–Ω—ñ –ü—ñ–≤–Ω—ñ—á–Ω–∞ –ê–º–µ—Ä–∏–∫–∞ (North America), –¥–µ –∑–Ω–∏–∂–∫–∞ –ø–µ—Ä–µ–≤–∏—â—É—î 15% —ñ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∏–π –∑–∞—Å—ñ–± –ø—ñ–¥—Ç—Ä–∏–º—É—î —à–≤–∏–¥–∫—É –∑–∞—Ä—è–¥–∫—É.

```sql
SELECT Brand, SUM(Revenue) AS Total_Revenue
FROM `gentle-respect-458915-s5.12.EV_cars`
WHERE Region = 'North America' AND Discount_Percentage > 15 AND Fast_Charging_Option = TRUE
GROUP BY Brand
ORDER BY Total_Revenue DESC;
```
#### ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: 
<img src="https://github.com/user-attachments/assets/db06f651-2f7d-4ff2-a7dd-40da3314b502" width="350">

–ë—Ä–µ–Ω–¥ Kia –ª—ñ–¥–∏—Ä—É—î –∑ –¥–æ—Ö–æ–¥–æ–º 2,470,858 —É –ü—ñ–≤–Ω—ñ—á–Ω—ñ–π –ê–º–µ—Ä–∏—Ü—ñ –∑–∞ —É–º–æ–≤ –∑–Ω–∏–∂–∫–∏ –ø–æ–Ω–∞–¥ 15% —ñ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ —à–≤–∏–¥–∫–æ—ó –∑–∞—Ä—è–¥–∫–∏, —â–æ —Å–≤—ñ–¥—á–∏—Ç—å –ø—Ä–æ —É—Å–ø—ñ—à–Ω—É –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—É —Å—Ç—Ä–∞—Ç–µ–≥—ñ—é. Ford (1,722,709) —ñ Nissan (848,784) —Ç–∞–∫–æ–∂ –ø–æ–∫–∞–∑—É—é—Ç—å –≤–∏—Å–æ–∫—ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏, —Ç–æ–¥—ñ —è–∫ Toyota –∑ –¥–æ—Ö–æ–¥–æ–º 357,124 –∑–∞–π–º–∞—î –æ—Å—Ç–∞–Ω–Ω—é –ø–æ–∑–∏—Ü—ñ—é

### –ó–∞–≤–¥–∞–Ω–Ω—è 2: –ù–∞–π–ø—Ä–∏–±—É—Ç–∫–æ–≤—ñ—à–∏–π –±—Ä–µ–Ω–¥ —É –∫–æ–∂–Ω–æ–º—É —Ä–µ–≥—ñ–æ–Ω—ñ
**–ú–µ—Ç–∞**: –î–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ä–µ–≥—ñ–æ–Ω—É (Region) –∑–Ω–∞–π—Ç–∏ –±—Ä–µ–Ω–¥ (Brand), —è–∫–∏–π –º–∞—î –Ω–∞–π–±—ñ–ª—å—à–∏–π —Å—É–º–∞—Ä–Ω–∏–π –¥–æ—Ö—ñ–¥ (Revenue), —ñ –≤–∏–∑–Ω–∞—á–∏—Ç–∏, —è–∫—É —á–∞—Å—Ç–∫—É (—É –≤—ñ–¥—Å–æ—Ç–∫–∞—Ö) —Ü–µ–π –¥–æ—Ö—ñ–¥ —Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—ñ–¥ –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ –¥–æ—Ö–æ–¥—É —Ä–µ–≥—ñ–æ–Ω—É.

```sql
WITH RevenueByBrandRegion AS (
  SELECT Region, Brand, SUM(Revenue) AS Total_Revenue
  FROM `gentle-respect-458915-s5.12.EV_cars`
  GROUP BY Region, Brand),
RegionTotals AS (
  SELECT Region, SUM(Revenue) AS Region_Total_Revenue
  FROM `gentle-respect-458915-s5.12.EV_cars`
  GROUP BY Region),
RankedBrands AS (
  SELECT 
    rbr.Region,
    rbr.Brand,
    rbr.Total_Revenue AS Top_Revenue,
    rt.Region_Total_Revenue,
    ROW_NUMBER() OVER (PARTITION BY rbr.Region ORDER BY rbr.Total_Revenue DESC) AS rank
  FROM RevenueByBrandRegion rbr
  JOIN RegionTotals rt ON rbr.Region = rt.Region)
SELECT 
  Region,
  Brand,
  Top_Revenue,
  Region_Total_Revenue,
  ROUND((Top_Revenue / Region_Total_Revenue) * 100, 2) AS Revenue_Share_Percentage
FROM RankedBrands
WHERE rank = 1
ORDER BY Region;
```
#### ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: 
<img src="https://github.com/user-attachments/assets/c488cac1-e01b-46d2-ba94-c89ae4d88e9a" width="600">

–ë—Ä–µ–Ω–¥ Toyota –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –Ω–∞–π–±—ñ–ª—å—à—É —á–∞—Å—Ç–∫—É –¥–æ—Ö–æ–¥—É (22.35%) —É –ê—Ñ—Ä–∏—Ü—ñ –∑ –¥–æ—Ö–æ–¥–æ–º 1,248,52791, —Ç–æ–¥—ñ —è–∫ Kia –ª—ñ–¥–∏—Ä—É—î –≤ –ê–∑—ñ—ó –∑ 19.12% (590,0556). –£ –ü—ñ–≤–Ω—ñ—á–Ω—ñ–π –ê–º–µ—Ä–∏—Ü—ñ Hyundai –º–∞—î 15.81% (11,474,486), –∞ BYD —É –ü—ñ–≤–¥–µ–Ω–Ω—ñ–π –ê–º–µ—Ä–∏—Ü—ñ ‚Äî 17.19% (3,065,970), —â–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î —Ä–µ–≥—ñ–æ–Ω–∞–ª—å–Ω—É —Å–ø–µ—Ü–∏—Ñ—ñ–∫—É –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç—ñ –±—Ä–µ–Ω–¥—ñ–≤.

### –ó–∞–≤–¥–∞–Ω–Ω—è 3: –ë—Ä–µ–Ω–¥–∏ –∑ –Ω–∞–π–≤–∏—â–æ—é —Å–µ—Ä–µ–¥–Ω—å–æ—é –∑–Ω–∏–∂–∫–æ—é –≤ —Ä–µ–≥—ñ–æ–Ω–∞—Ö
**–ú–µ—Ç–∞**: –í–∏–∑–Ω–∞—á–∏—Ç–∏ –±—Ä–µ–Ω–¥–∏ (Brand), —è–∫—ñ –º–∞—é—Ç—å –Ω–∞–π–≤–∏—â—É —Å–µ—Ä–µ–¥–Ω—é –∑–Ω–∏–∂–∫—É (Discount_Percentage) —É –∫–æ–∂–Ω–æ–º—É —Ä–µ–≥—ñ–æ–Ω—ñ (Region), –≤—Ä–∞—Ö–æ–≤—É—é—á–∏ –ª–∏—à–µ –±—Ä–µ–Ω–¥–∏ –∑—ñ –∑–Ω–∏–∂–∫–æ—é –ø–æ–Ω–∞–¥ 10%. –î–ª—è —Ç–∞–∫–∏—Ö –±—Ä–µ–Ω–¥—ñ–≤ –ø—ñ–¥—Ä–∞—Ö—É–≤–∞—Ç–∏ —Å–µ—Ä–µ–¥–Ω—é —î–º–Ω—ñ—Å—Ç—å –±–∞—Ç–∞—Ä–µ—ó (Battery_Capacity_kWh) —Ç–∞ –∑–∞–≥–∞–ª—å–Ω–∏–π –¥–æ—Ö—ñ–¥ (Revenue).

```sql
WITH CTE AS (
  SELECT Region, Brand,
    AVG(Discount_Percentage) AS avg_discount_percentage,
    ROUND(AVG(Battery_Capacity_kWh), 2) AS avg_battery_capacity,
    SUM(Revenue) AS total_revenue
  FROM `gentle-respect-458915-s5.12.EV_cars`
  GROUP BY Region, Brand
  HAVING AVG(Discount_Percentage) > 10
),
CTE2 AS (
  SELECT Region, Brand, avg_discount_percentage, avg_battery_capacity, total_revenue,
    ROW_NUMBER() OVER (PARTITION BY Region ORDER BY avg_discount_percentage DESC) AS rank
  FROM CTE
)
SELECT Region, Brand,
  avg_discount_percentage AS Avg_Discount_Percentage,
  avg_battery_capacity AS Avg_Battery_Capacity_kWh,
  total_revenue AS Total_Revenue
FROM CTE2
WHERE rank = 1
ORDER BY total_revenue DESC;
```
#### ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: 
<img src="https://github.com/user-attachments/assets/ca4b7bef-9e33-4cfa-be95-f6580abb02ee" width="600">

Kia —É –ü—ñ–≤–Ω—ñ—á–Ω—ñ–π –ê–º–µ—Ä–∏—Ü—ñ –º–∞—î –Ω–∞–π–≤–∏—â—É —Å–µ—Ä–µ–¥–Ω—é –∑–Ω–∏–∂–∫—É (11.36%) –∑ –¥–æ—Ö–æ–¥–æ–º 113144270, —Ç–æ–¥—ñ —è–∫ Toyota —É –ü—ñ–≤–¥–µ–Ω–Ω—ñ–π –ê–º–µ—Ä–∏—Ü—ñ –ø—Ä–æ–ø–æ–Ω—É—î –Ω–∞–π–±—ñ–ª—å—à—É –∑–Ω–∏–∂–∫—É (16.5%) –ø—Ä–∏ –¥–æ—Ö–æ–¥—ñ 10727248. –£ –Ñ–≤—Ä–æ–ø—ñ Volkswagen –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –∑–Ω–∏–∂–∫—É 12.5% –∑ –¥–æ—Ö–æ–¥–æ–º 16700280, –∞ BYD –≤ –ê—Ñ—Ä–∏—Ü—ñ ‚Äî 11.0% –∑ –¥–æ—Ö–æ–¥–æ–º 24763916, —â–æ –ø—ñ–¥–∫—Ä–µ—Å–ª—é—î —Ä–µ–≥—ñ–æ–Ω–∞–ª—å–Ω—ñ –≤—ñ–¥–º—ñ–Ω–Ω–æ—Å—Ç—ñ —É —Å—Ç—Ä–∞—Ç–µ–≥—ñ—è—Ö –∑–Ω–∏–∂–æ–∫ —Ç–∞ –¥–æ—Ö–æ–¥–∞—Ö –±—Ä–µ–Ω–¥—ñ–≤

### –ó–∞–≤–¥–∞–Ω–Ω—è 4: –†–∏–Ω–∫–æ–≤–∞ —á–∞—Å—Ç–∫–∞ –±—Ä–µ–Ω–¥—ñ–≤ –∑–∞ –º—ñ—Å—è—Ü—è–º–∏
**–ú–µ—Ç–∞**: –î–ª—è –∫–æ–∂–Ω–æ–≥–æ –º—ñ—Å—è—Ü—è (Date) —ñ –±—Ä–µ–Ω–¥—É (Brand) –ø—ñ–¥—Ä–∞—Ö—É–≤–∞—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–¥–∞–Ω–∏—Ö –æ–¥–∏–Ω–∏—Ü—å (Units_Sold), –∑–∞–≥–∞–ª—å–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–¥–∞–Ω–∏—Ö –æ–¥–∏–Ω–∏—Ü—å —É –º—ñ—Å—è—Ü—ñ —Ç–∞ —Ä–∏–Ω–∫–æ–≤—É —á–∞—Å—Ç–∫—É –±—Ä–µ–Ω–¥—É (—É –≤—ñ–¥—Å–æ—Ç–∫–∞—Ö).

```sql
SELECT
    date,
    Brand,
    SUM(Units_Sold) AS Brand_Sold,
    SUM(SUM(Units_Sold)) OVER (PARTITION BY date) AS Total_Month_Sold,
    ROUND(
        SUM(Units_Sold) * 100.0 / SUM(SUM(Units_Sold)) OVER (PARTITION BY date), 
        2
    ) AS Brand_Market_Share
FROM `12.EV_cars`
GROUP BY date, Brand
ORDER BY date, Brand_Market_Share DESC;
```
#### ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: 
<img src="https://github.com/user-attachments/assets/a2e468b8-e0f6-4a48-a404-ff8c87d03cfc" width="600">

–£ —Å—ñ—á–Ω—ñ 2023 —Ä–æ–∫—É BMW –ª—ñ–¥–∏—Ä—É—î –∑ —Ä–∏–Ω–∫–æ–≤–æ—é —á–∞—Å—Ç–∫–æ—é 19.77% (2393 –æ–¥–∏–Ω–∏—Ü—ñ), –∑–∞ –Ω–∏–º –π–¥—É—Ç—å Ford –∑ 17.91% (2168 –æ–¥–∏–Ω–∏—Ü—å) —Ç–∞ Kia –∑ 17.08% (2068 –æ–¥–∏–Ω–∏—Ü—å). Tesla —Ç–∞ BYD –º–∞—é—Ç—å –Ω–∞–π–º–µ–Ω—à—ñ —á–∞—Å—Ç–∫–∏ ‚Äî 3.03% (367 –æ–¥–∏–Ω–∏—Ü—å) —Ç–∞ 3.68% (445 –æ–¥–∏–Ω–∏—Ü—å) –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ, —â–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –∑–Ω–∞—á–Ω—É –ø–µ—Ä–µ–≤–∞–≥—É —î–≤—Ä–æ–ø–µ–π—Å—å–∫–∏—Ö —Ç–∞ –∫–æ—Ä–µ–π—Å—å–∫–∏—Ö –±—Ä–µ–Ω–¥—ñ–≤ —É —Ü—å–æ–º—É –º—ñ—Å—è—Ü—ñ. –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –æ—Ö–æ–ø–ª—é—é—Ç—å –±–∞–≥–∞—Ç–æ –º—ñ—Å—è—Ü—ñ–≤, –∞–ª–µ —Ç—É—Ç –Ω–∞–≤–µ–¥–µ–Ω–æ –ø—Ä–∏–∫–ª–∞–¥ –ª–∏—à–µ –∑–∞ —Å—ñ—á–µ–Ω—å 2023 —Ä–æ–∫—É.

### –ó–∞–≤–¥–∞–Ω–Ω—è 5: –ê–Ω–∞–ª—ñ–∑ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –∑–Ω–∏–∂–æ–∫
**–ú–µ—Ç–∞**: –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏, —á–∏ –≤–ø–ª–∏–≤–∞—é—Ç—å –∑–Ω–∏–∂–∫–∏ (Discount_Percentage) –Ω–∞ –ø—Ä–æ–¥–∞–∂—ñ (Units_Sold), –ø–æ—Ä—ñ–≤–Ω—é—é—á–∏ —Å–µ—Ä–µ–¥–Ω—ñ –ø—Ä–æ–¥–∞–∂—ñ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ä—ñ–≤–Ω—ñ–≤ –∑–Ω–∏–∂–æ–∫ —É –∫–æ–∂–Ω–æ–º—É —Ä–µ–≥—ñ–æ–Ω—ñ (Region).

```sql
WITH DiscountLevels AS (
    SELECT 
        Region,
        CASE 
            WHEN Discount_Percentage = 0 THEN 'No Discount'
            WHEN Discount_Percentage BETWEEN 1 AND 10 THEN 'Low (1-10%)'
            WHEN Discount_Percentage BETWEEN 11 AND 20 THEN 'Medium (11-20%)'
            ELSE 'High (>20%)'
        END AS Discount_Level,
        AVG(Units_Sold) AS Avg_Units_Sold,
        AVG(Discount_Percentage) AS Avg_Discount
    FROM `12.EV_cars`
    GROUP BY Region, 
        CASE 
            WHEN Discount_Percentage = 0 THEN 'No Discount'
            WHEN Discount_Percentage BETWEEN 1 AND 10 THEN 'Low (1-10%)'
            WHEN Discount_Percentage BETWEEN 11 AND 20 THEN 'Medium (11-20%)'
            ELSE 'High (>20%)'END)
SELECT 
    Region,
    Discount_Level,
    ROUND(Avg_Discount, 2) AS Average_Discount,
    ROUND(Avg_Units_Sold, 2) AS Average_Units_Sold
FROM DiscountLevels
ORDER BY Region, Avg_Units_Sold DESC;
```
#### ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: 
<img src="https://github.com/user-attachments/assets/5aea626a-9319-44d2-86ba-3f85f63a12fa" width="600">

–£ –ê—Ñ—Ä–∏—Ü—ñ —Å–µ—Ä–µ–¥–Ω—ñ –ø—Ä–æ–¥–∞–∂—ñ –Ω–∞–π–±—ñ–ª—å—à—ñ –ø—Ä–∏ —Å–µ—Ä–µ–¥–Ω—ñ–π –∑–Ω–∏–∂—Ü—ñ 14.82% (237.33 –æ–¥–∏–Ω–∏—Ü—å), —Ç–æ–¥—ñ —è–∫ —É –Ñ–≤—Ä–æ–ø—ñ —Å–µ—Ä–µ–¥–Ω—è –∑–Ω–∏–∂–∫–∞ 15.58% –∑–∞–±–µ–∑–ø–µ—á—É—î 253.58 –æ–¥–∏–Ω–∏—Ü—å. –£ –ü—ñ–≤–Ω—ñ—á–Ω—ñ–π –ê–º–µ—Ä–∏—Ü—ñ –Ω–∞–π–±—ñ–ª—å—à—ñ –ø—Ä–æ–¥–∞–∂—ñ (223.02 –æ–¥–∏–Ω–∏—Ü—ñ) —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –ø—Ä–∏ –∑–Ω–∏–∂—Ü—ñ 15.5%, —Ç–æ–¥—ñ —è–∫ —É –ê–∑—ñ—ó –ø—Ä–∏ –≤—ñ–¥—Å—É—Ç–Ω–æ—Å—Ç—ñ –∑–Ω–∏–∂–æ–∫ –ø—Ä–æ–¥–∞–∂—ñ –Ω–∏–∂—á—ñ (201.0 –æ–¥–∏–Ω–∏—Ü—å), —â–æ –≤–∫–∞–∑—É—î –Ω–∞ —Ä—ñ–∑–Ω–∏–π –≤–ø–ª–∏–≤ –∑–Ω–∏–∂–æ–∫ –Ω–∞ –ø—Ä–æ–¥–∞–∂—ñ –≤ —Ä–µ–≥—ñ–æ–Ω–∞—Ö.

### –ó–∞–≤–¥–∞–Ω–Ω—è 6: –°–µ—Ä–µ–¥–Ω—ñ–π –¥–æ—Ö—ñ–¥ –Ω–∞ –æ–¥–∏–Ω–∏—Ü—é –∑–∞ —Ç–∏–ø–æ–º —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ –∑–∞—Å–æ–±—É
**–ú–µ—Ç–∞**: –ü—ñ–¥—Ä–∞—Ö—É–≤–∞—Ç–∏ —Å–µ—Ä–µ–¥–Ω—ñ–π –¥–æ—Ö—ñ–¥ –Ω–∞ –æ–¥–∏–Ω–∏—Ü—é (Revenue / Units_Sold) –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ç–∏–ø—É —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–≥–æ –∑–∞—Å–æ–±—É (Vehicle_Type) —É —Ä–µ–≥—ñ–æ–Ω–∞—Ö, –¥–µ –ø—Ä–æ–¥–∞–∂—ñ –ø–µ—Ä–µ–≤–∏—â—É—é—Ç—å 200 –æ–¥–∏–Ω–∏—Ü—å, —â–æ–± –æ—Ü—ñ–Ω–∏—Ç–∏ –ø—Ä–∏–±—É—Ç–∫–æ–≤—ñ—Å—Ç—å.

```sql
SELECT 
    Vehicle_Type,
    Region,
    ROUND(SUM(Revenue) / SUM(Units_Sold), 2) AS Avg_Revenue_Per_Unit,
    SUM(Units_Sold) AS Total_Units_Sold
FROM `12.EV_cars`
GROUP BY Vehicle_Type, Region
HAVING SUM(Units_Sold) > 200
ORDER BY Avg_Revenue_Per_Unit DESC;
```
#### ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: 
<img src="https://github.com/user-attachments/assets/8b986b78-d5b0-455b-8205-83bc9999debd" width="600">

–ù–∞–π–≤–∏—â–∏–π —Å–µ—Ä–µ–¥–Ω—ñ–π –¥–æ—Ö—ñ–¥ –Ω–∞ –æ–¥–∏–Ω–∏—Ü—é (23855.28) —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –¥–ª—è SUV –≤ –ê–∑—ñ—ó (2467 –æ–¥–∏–Ω–∏—Ü—å), —Ç–æ–¥—ñ —è–∫ —É –ü—ñ–≤–Ω—ñ—á–Ω—ñ–π –ê–º–µ—Ä–∏—Ü—ñ SUV –º–∞—î –¥–æ—Ö—ñ–¥ 23554.05 (4067 –æ–¥–∏–Ω–∏—Ü—å). –£ –ê—Ñ—Ä–∏—Ü—ñ –∫—Ä–æ—Å–æ–≤–µ—Ä–∏ –¥–æ—Å—è–≥–∞—é—Ç—å 24449.52 (2186 –æ–¥–∏–Ω–∏—Ü—å), –∞ –≤ –û–∫–µ–∞–Ω—ñ—ó —Ö–µ—Ç—á–±–µ–∫–∏ ‚Äî 22288.63 (12096 –æ–¥–∏–Ω–∏—Ü—å), —â–æ –≤–∫–∞–∑—É—î –Ω–∞ —Ä—ñ–∑–Ω—É –ø—Ä–∏–±—É—Ç–∫–æ–≤—ñ—Å—Ç—å —Ç–∏–ø—ñ–≤ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∏—Ö –∑–∞—Å–æ–±—ñ–≤ —É —Ä–µ–≥—ñ–æ–Ω–∞—Ö.

### –ó–∞–≤–¥–∞–Ω–Ω—è 7: –í–ø–ª–∏–≤ —Å–µ–≥–º–µ–Ω—Ç—É –∫–ª—ñ—î–Ω—Ç—ñ–≤ –Ω–∞ —Å–µ—Ä–µ–¥–Ω—é –∑–Ω–∏–∂–∫—É
**–ú–µ—Ç–∞**: –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏, —è–∫ —Å–µ–≥–º–µ–Ω—Ç –∫–ª—ñ—î–Ω—Ç—ñ–≤ (Customer_Segment) –≤–ø–ª–∏–≤–∞—î –Ω–∞ —Å–µ—Ä–µ–¥–Ω—é –∑–Ω–∏–∂–∫—É (Discount_Percentage), —â–æ–± –∑—Ä–æ–∑—É–º—ñ—Ç–∏ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—ó —Ü—ñ–Ω–æ—É—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö –∞—É–¥–∏—Ç–æ—Ä—ñ–π.

```sql
SELECT 
    Customer_Segment,
    ROUND(AVG(Discount_Percentage), 2) AS Avg_Discount_Percentage,
    COUNT(*) AS Total_Records,
    SUM(Units_Sold) AS Total_Units_Sold
FROM `12.EV_cars`
GROUP BY Customer_Segment
ORDER BY Avg_Discount_Percentage DESC;
```
#### ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: 
<img src="https://github.com/user-attachments/assets/a6ecb474-9f99-42f2-b9f6-636e1b1b6796" width="600">

–ù–∞–π–≤–∏—â—É —Å–µ—Ä–µ–¥–Ω—é –∑–Ω–∏–∂–∫—É (9.6%) –æ—Ç—Ä–∏–º—É—é—Ç—å –∫–ª—ñ—î–Ω—Ç–∏ —Å–µ–≥–º–µ–Ω—Ç—É High Income (27960 –æ–¥–∏–Ω–∏—Ü—å), —â–æ –º–æ–∂–µ –≤–∫–∞–∑—É–≤–∞—Ç–∏ –Ω–∞ —Å—Ç—Ä–∞—Ç–µ–≥—ñ—é –∑–∞–ª—É—á–µ–Ω–Ω—è –ø—Ä–µ–º—ñ—É–º-–∞—É–¥–∏—Ç–æ—Ä—ñ—ó. Eco-Conscious —Å–µ–≥–º–µ–Ω—Ç –º–∞—î –∑–Ω–∏–∂–∫—É 9.16% (21127 –æ–¥–∏–Ω–∏—Ü—å), —Ç–æ–¥—ñ —è–∫ Budget Conscious (8.69%, 29449 –æ–¥–∏–Ω–∏—Ü—å) —Ç–∞ Middle Income (8.48%, 15919 –æ–¥–∏–Ω–∏—Ü—å) –æ—Ç—Ä–∏–º—É—é—Ç—å –º–µ–Ω—à—ñ –∑–Ω–∏–∂–∫–∏, –≤—ñ–¥–æ–±—Ä–∞–∂–∞—é—á–∏ –¥–∏—Ñ–µ—Ä–µ–Ω—Ü—ñ–π–æ–≤–∞–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ —Ü—ñ–Ω–æ—É—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Å–µ–≥–º–µ–Ω—Ç—É.

### –ó–∞–≤–¥–∞–Ω–Ω—è 8: –¢–æ–ø-5 –±—Ä–µ–Ω–¥—ñ–≤ —ñ–∑ –Ω–∞–π–±—ñ–ª—å—à–∏–º –¥–æ—Ö–æ–¥–æ–º —Ç–∞ —ó—Ö–Ω—ñ–π –≤–Ω–µ—Å–æ–∫ —É –∑–∞–≥–∞–ª—å–Ω–∏–π –¥–æ—Ö—ñ–¥
**–ú–µ—Ç–∞**: –í–∏–∑–Ω–∞—á–∏—Ç–∏ —Ç–æ–ø-5 –±—Ä–µ–Ω–¥—ñ–≤ (Brand) —ñ–∑ –Ω–∞–π–±—ñ–ª—å—à–∏–º —Å—É–º–∞—Ä–Ω–∏–º –¥–æ—Ö–æ–¥–æ–º (Revenue) —ñ —Ä–æ–∑—Ä–∞—Ö—É–≤–∞—Ç–∏ —ó—Ö–Ω—é —á–∞—Å—Ç–∫—É —É –∑–∞–≥–∞–ª—å–Ω–æ–º—É –¥–æ—Ö–æ–¥—ñ, –∞ —Ç–∞–∫–æ–∂ –ø–æ–∫–∞–∑–∞—Ç–∏ –∫—É–º—É–ª—è—Ç–∏–≤–Ω–∏–π –¥–æ—Ö—ñ–¥ –ø–æ –º—ñ—Ä—ñ –∑—Ä–æ—Å—Ç–∞–Ω–Ω—è.

```sql
SELECT 
    Brand,
    Total_Revenue,
    ROUND((Total_Revenue / SUM(Total_Revenue) OVER ()) * 100, 2) AS Revenue_Share_Percentage,
    SUM(Total_Revenue) OVER (ORDER BY Total_Revenue DESC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS Cumulative_Revenue
FROM (
    SELECT
        Brand,
        SUM(Revenue) AS Total_Revenue
    FROM `12.EV_cars`
    GROUP BY Brand) AS BrandTotals
ORDER BY Total_Revenue DESC
LIMIT 5;
```

#### ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç: 
<img src="https://github.com/user-attachments/assets/74444b7a-64f5-4501-b584-fed311628fc4" width="600">

Kia –¥–µ–º–æ–Ω—Å—Ç—Ä—É—î –Ω–∞–π–±—ñ–ª—å—à–∏–π —Å—É–º–∞—Ä–Ω–∏–π –¥–æ—Ö—ñ–¥ —É —Ä–æ–∑–º—ñ—Ä—ñ 382151251$, —â–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—å 14.63% –∑–∞–≥–∞–ª—å–Ω–æ–≥–æ –¥–æ—Ö–æ–¥—É, –∑–∞–π–º–∞—é—á–∏ –ø—Ä–æ–≤—ñ–¥–Ω—É –ø–æ–∑–∏—Ü—ñ—é. BMW (358120737$, 13.71%) —ñ Hyundai (351716271$, 13.47%) —Ç–∞–∫–æ–∂ –º–∞—é—Ç—å –∑–Ω–∞—á–Ω–∏–π –≤–Ω–µ—Å–æ–∫, —Ç–æ–¥—ñ —è–∫ Ford (295197328$, 11.3%) —ñ Nissan (291035195$, 11.14%) –∑–∞–≤–µ—Ä—à—É—é—Ç—å —Ç–æ–ø-5. –ö—É–º—É–ª—è—Ç–∏–≤–Ω–∏–π –¥–æ—Ö—ñ–¥ –¥–æ—Å—è–≥–∞—î 1678220782$ –¥–ª—è —Ü–∏—Ö –ø‚Äô—è—Ç–∏ –±—Ä–µ–Ω–¥—ñ–≤, —â–æ –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î —ó—Ö–Ω—ñ–π –¥–æ–º—ñ–Ω—É—é—á–∏–π –≤–ø–ª–∏–≤ –Ω–∞ –∑–∞–≥–∞–ª—å–Ω—É –≤–∏—Ä—É—á–∫—É.

### –ö–æ—Ä–æ—Ç–∫–∏–π –∑–∞–≥–∞–ª—å–Ω–∏–π –≤–∏—Å–Ω–æ–≤–æ–∫
üåü –ê–Ω–∞–ª—ñ–∑ –ø—Ä–æ–¥–∞–∂—ñ–≤ –µ–ª–µ–∫—Ç—Ä–æ–º–æ–±—ñ–ª—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é SQL –≤–∏—è–≤–∏–≤ –∫–ª—é—á–æ–≤—ñ —Ç–µ–Ω–¥–µ–Ω—Ü—ñ—ó: Kia —Ç–∞ BMW –¥–µ–º–æ–Ω—Å—Ç—Ä—É—é—Ç—å –ª—ñ–¥–µ—Ä—Å—Ç–≤–æ –≤ –¥–æ—Ö–æ–¥–∞—Ö —ñ —Ä–∏–Ω–∫–æ–≤—ñ–π —á–∞—Å—Ç—Ü—ñ, –æ—Å–æ–±–ª–∏–≤–æ –≤ –ü—ñ–≤–Ω—ñ—á–Ω—ñ–π –ê–º–µ—Ä–∏—Ü—ñ —Ç–∞ –ê–∑—ñ—ó, –∑ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–∏–º –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º –∑–Ω–∏–∂–æ–∫ –¥–ª—è —Å–µ–≥–º–µ–Ω—Ç—É High Income. üìà –ó–Ω–∏–∂–∫–∏ –∑–Ω–∞—á–Ω–æ –≤–ø–ª–∏–≤–∞—é—Ç—å –Ω–∞ –ø—Ä–æ–¥–∞–∂—ñ, –æ—Å–æ–±–ª–∏–≤–æ –≤ –Ñ–≤—Ä–æ–ø—ñ —Ç–∞ –ê—Ñ—Ä–∏—Ü—ñ, –¥–µ —Å–µ—Ä–µ–¥–Ω—ñ –ø—Ä–æ–¥–∞–∂—ñ –∑—Ä–æ—Å—Ç–∞—é—Ç—å –ø—Ä–∏ –∑–Ω–∏–∂–∫–∞—Ö 15-16%. üöó SUV —ñ –∫—Ä–æ—Å–æ–≤–µ—Ä–∏ —î –Ω–∞–π–±—ñ–ª—å—à –ø—Ä–∏–±—É—Ç–∫–æ–≤–∏–º–∏ —Ç–∏–ø–∞–º–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–∏—Ö –∑–∞—Å–æ–±—ñ–≤, –æ—Å–æ–±–ª–∏–≤–æ –≤ –ê–∑—ñ—ó —Ç–∞ –ê—Ñ—Ä–∏—Ü—ñ. üåç –†–µ–≥—ñ–æ–Ω–∞–ª—å–Ω—ñ –≤—ñ–¥–º—ñ–Ω–Ω–æ—Å—Ç—ñ –ø—ñ–¥–∫—Ä–µ—Å–ª—é—é—Ç—å –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ—Å—Ç—å –∞–¥–∞–ø—Ç–∏–≤–Ω–∏—Ö –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤–∏—Ö —Å—Ç—Ä–∞—Ç–µ–≥—ñ–π –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Å–µ–≥–º–µ–Ω—Ç—ñ–≤ —ñ —Ä–∏–Ω–∫—ñ–≤. üéØ




